# Chizu 1차 MVP 기획서

## 1. 프로젝트 개요

### 1.1 프로젝트명
**Chizu (地図)** - 지역별 방문 기록 시각화 지도 다이어리

### 1.2 목표
한국 지도를 행정구역 단위로 탐색하며 방문 기록을 남기고, 히트맵으로 시각화하는 웹 애플리케이션 개발

### 1.3 타겟 사용자
- 여행/맛집 탐방을 기록하고 싶은 개인 사용자
- 지역별 방문 현황을 시각적으로 확인하고 싶은 사용자

---

## 2. 핵심 기능 명세

### 2.1 지도 시각화

#### 지도 계층 구조
```
Level 1: 전국 (시/도 17개)
    ↓ 클릭
Level 2: 시/도 상세 (시/군/구 ~250개)
    ↓ 확대/클릭
Level 3: 상세 (핀 마커)
```

#### 시/도 목록 (17개)
| 코드 | 시/도명 |
|------|---------|
| 11 | 서울특별시 |
| 26 | 부산광역시 |
| 27 | 대구광역시 |
| 28 | 인천광역시 |
| 29 | 광주광역시 |
| 30 | 대전광역시 |
| 31 | 울산광역시 |
| 36 | 세종특별자치시 |
| 41 | 경기도 |
| 42 | 강원특별자치도 |
| 43 | 충청북도 |
| 44 | 충청남도 |
| 45 | 전라북도 |
| 46 | 전라남도 |
| 47 | 경상북도 |
| 48 | 경상남도 |
| 50 | 제주특별자치도 |

#### 지도 인터랙션
| 동작 | 기능 |
|------|------|
| 클릭 | 지역 선택 → 모달 표시 또는 드릴다운 |
| 호버 | 지역명 툴팁 표시 |
| 휠 스크롤 | 확대/축소 |
| 드래그 | 패닝 (지도 이동) |
| 더블클릭 | 해당 지역으로 드릴다운 |

### 2.2 히트맵 시각화

#### 색상 등급
| 등급 | 방문 횟수 | 색상 코드 |
|------|----------|-----------|
| 0 | 0회 | #E5E7EB (회색) |
| 1 | 1-5회 | #BFDBFE (연한 파랑) |
| 2 | 6-20회 | #86EFAC (초록) |
| 3 | 21-50회 | #FDE047 (노랑) |
| 4 | 51-100회 | #FB923C (주황) |
| 5 | 100회+ | #F87171 (빨강) |

#### 계산 방식
- 해당 지역(시/도 또는 시/군/구)에 속한 기록의 총 개수
- 핀 마커가 있는 기록만 카운트 OR 지역 선택만 한 기록도 카운트 (TBD)

### 2.3 핀 마커

#### 마커 표시 조건
- 좌표(lat, lng)가 있는 기록만 핀으로 표시
- 시/군/구 레벨에서 표시
- 동일 위치 다수 기록 시 클러스터링 또는 숫자 뱃지

#### 마커 스타일
- 기본: 원형 마커
- 카테고리별 색상/아이콘 구분 (선택)

### 2.4 반응형 모달

#### 모달 트리거
1. 지역(시/도, 시/군/구) 클릭
2. 핀 마커 클릭
3. 새 기록 추가 버튼

#### 모달 레이아웃 (지역 선택 시)
```
┌─────────────────────────────────────┐
│ [←] 서울특별시 > 강남구        [X]  │
├─────────────────────────────────────┤
│ 기록 12개                           │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 2026.01.25                      │ │
│ │ 강남 카페 탐방                    │ │
│ │ #카페 #디저트                    │ │
│ └─────────────────────────────────┘ │
│ ┌─────────────────────────────────┐ │
│ │ 2026.01.20                      │ │
│ │ 압구정 맛집                      │ │
│ │ #맛집 #한식                      │ │
│ └─────────────────────────────────┘ │
│                                     │
│ [ + 새 기록 추가 ]                   │
└─────────────────────────────────────┘
```

#### 모달 레이아웃 (기록 상세/편집)
```
┌─────────────────────────────────────┐
│ 기록 추가                      [X]  │
├─────────────────────────────────────┤
│ 제목 *                              │
│ ┌─────────────────────────────────┐ │
│ │                                 │ │
│ └─────────────────────────────────┘ │
│                                     │
│ 위치 *                              │
│ [서울특별시 ▼] [강남구 ▼]           │
│                                     │
│ 상세 주소 (선택)                     │
│ ┌─────────────────────────────────┐ │
│ │                                 │ │
│ └─────────────────────────────────┘ │
│                                     │
│ 방문 날짜 *                          │
│ [ 2026-01-27 ]                      │
│                                     │
│ 카테고리                             │
│ [카페] [맛집] [여행] [기타]          │
│                                     │
│ 메모                                │
│ ┌─────────────────────────────────┐ │
│ │                                 │ │
│ │                                 │ │
│ └─────────────────────────────────┘ │
│                                     │
│ 사진 (선택)                          │
│ [+ 사진 추가]                        │
│                                     │
│       [ 취소 ]  [ 저장 ]             │
└─────────────────────────────────────┘
```

### 2.5 기록 CRUD

#### Create (생성)
- 필수: 제목, 위치(시/도 + 시/군/구), 방문 날짜
- 선택: 상세 주소, 좌표, 카테고리, 메모, 사진

#### Read (조회)
- 지역별 기록 목록
- 기록 상세 보기
- 전체 기록 목록 (날짜순, 지역순)

#### Update (수정)
- 모든 필드 수정 가능
- 수정 시 updatedAt 갱신

#### Delete (삭제)
- 삭제 확인 다이얼로그
- 소프트 삭제 vs 하드 삭제 (TBD)

### 2.6 로컬 저장

#### IndexedDB 스키마
```typescript
// Database: ChizuDB
// Version: 1

// Table: records
{
  id: string (primary key, auto-generated UUID)
  sido: string (indexed)
  sigungu: string (indexed)
  address?: string
  lat?: number
  lng?: number
  title: string
  memo?: string
  category?: string (indexed)
  photos?: Blob[]
  visitedAt: string (indexed)
  createdAt: string
  updatedAt: string
}
```

---

## 3. 화면 설계

### 3.1 메인 페이지

```
┌─────────────────────────────────────────────────┐
│  Chizu                          [전체기록] [+]  │
├─────────────────────────────────────────────────┤
│                                                 │
│                                                 │
│              ┌─────────────┐                    │
│              │             │                    │
│              │   한국 지도  │                    │
│              │  (히트맵)    │                    │
│              │             │                    │
│              └─────────────┘                    │
│                                                 │
│                      [−] [+]  ← 줌 컨트롤        │
│                                                 │
├─────────────────────────────────────────────────┤
│  [범례]  □ 0  ■ 1-5  ■ 6-20  ■ 21-50  ■ 51+   │
├─────────────────────────────────────────────────┤
│  최근 기록                                       │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐           │
│  │ 1/25    │ │ 1/20    │ │ 1/15    │           │
│  │ 강남    │ │ 홍대    │ │ 부산    │           │
│  └─────────┘ └─────────┘ └─────────┘           │
└─────────────────────────────────────────────────┘
```

### 3.2 시/군/구 드릴다운

```
┌─────────────────────────────────────────────────┐
│  [←] 서울특별시                  [전체기록] [+]  │
├─────────────────────────────────────────────────┤
│                                                 │
│              ┌─────────────┐                    │
│              │             │                    │
│              │ 서울 시/군/구│                    │
│              │  (히트맵)    │                    │
│              │    • 핀     │                    │
│              │        •    │                    │
│              └─────────────┘                    │
│                                                 │
│                      [−] [+]                    │
│                                                 │
├─────────────────────────────────────────────────┤
│  서울특별시 기록 45개                            │
└─────────────────────────────────────────────────┘
```

---

## 4. 데이터 구조

### 4.1 Record 타입

```typescript
interface Record {
  id: string

  // 위치
  sido: string           // 필수: "서울특별시"
  sigungu: string        // 필수: "강남구"
  address?: string       // 선택: "테헤란로 123"
  coordinates?: {
    lat: number
    lng: number
  }

  // 내용
  title: string          // 필수
  memo?: string
  category?: Category
  photos?: Photo[]

  // 시간
  visitedAt: string      // ISO 8601: "2026-01-27"
  createdAt: string
  updatedAt: string
}

type Category = 'cafe' | 'restaurant' | 'travel' | 'culture' | 'etc'

interface Photo {
  id: string
  blob: Blob
  thumbnail?: Blob
}
```

### 4.2 Map 상태 타입

```typescript
interface MapState {
  // 현재 뷰
  currentLevel: 'country' | 'sido'
  selectedSido?: string
  selectedSigungu?: string

  // 줌/패닝
  zoom: number
  center: { x: number; y: number }

  // UI 상태
  hoveredRegion?: string
  isModalOpen: boolean
  modalType?: 'region' | 'record' | 'form'
}
```

---

## 5. 기술 스택

| 분류 | 기술 | 버전 | 용도 |
|------|------|------|------|
| Framework | Next.js | 16.x | Pages Router |
| Language | TypeScript | 5.x | 타입 안전성 |
| Map Rendering | react-simple-maps | latest | GeoJSON → SVG |
| Geo Utilities | D3-geo | latest | 투영, 좌표 변환 |
| State | Zustand | latest | 전역 상태 관리 |
| Local DB | Dexie.js | latest | IndexedDB 래퍼 |
| Styling | styled-components | 6.x | CSS-in-JS |
| UI Components | Radix UI | latest | 모달, 드롭다운 등 |

---

## 6. 구현 순서

### Phase 1: 환경 설정
1. 추가 패키지 설치
2. 폴더 구조 생성
3. 타입 정의

### Phase 2: 데이터 준비
1. GeoJSON 데이터 수집 (시/도, 시/군/구)
2. 데이터 정제 및 최적화
3. 프로젝트에 포함

### Phase 3: 지도 기본 구현
1. 전국 지도 렌더링
2. 지역 클릭/호버 이벤트
3. 확대/축소/패닝

### Phase 4: 드릴다운 구현
1. 시/도 → 시/군/구 전환
2. 뒤로가기 네비게이션
3. 애니메이션 전환

### Phase 5: 데이터 레이어
1. IndexedDB 설정 (Dexie)
2. 기록 CRUD 함수
3. Zustand 스토어 연동

### Phase 6: UI 구현
1. 반응형 모달
2. 기록 폼
3. 기록 목록

### Phase 7: 시각화 구현
1. 히트맵 색상 적용
2. 핀 마커 렌더링
3. 범례 UI

### Phase 8: 통합 및 마무리
1. 페이지 통합 (pages/index.tsx에 컴포넌트 연결)
2. 반응형 대응
3. 에러 처리
4. 성능 최적화

---

## 7. GeoJSON 데이터

### 7.1 데이터 출처
- 통계청 통계지리정보서비스
- 국토교통부 국가공간정보포털
- GitHub: southkorea/seoul-maps 등 오픈소스

### 7.2 파일 구조
```
data/geojson/korea/
├── sido.json              # 시/도 17개 경계
└── sigungu/
    ├── seoul.json         # 서울 25개 구
    ├── busan.json         # 부산 16개 구/군
    ├── daegu.json         # 대구 8개 구/군
    ├── incheon.json       # 인천 10개 구/군
    ├── gwangju.json       # 광주 5개 구
    ├── daejeon.json       # 대전 5개 구
    ├── ulsan.json         # 울산 5개 구/군
    ├── sejong.json        # 세종 1개
    ├── gyeonggi.json      # 경기 31개 시/군
    ├── gangwon.json       # 강원 18개 시/군
    ├── chungbuk.json      # 충북 11개 시/군
    ├── chungnam.json      # 충남 15개 시/군
    ├── jeonbuk.json       # 전북 14개 시/군
    ├── jeonnam.json       # 전남 22개 시/군
    ├── gyeongbuk.json     # 경북 23개 시/군
    ├── gyeongnam.json     # 경남 18개 시/군
    └── jeju.json          # 제주 2개 시
```

### 7.3 GeoJSON 형식
```json
{
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": {
        "code": "11",
        "name": "서울특별시",
        "name_eng": "Seoul"
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [[[...], ...]]
      }
    }
  ]
}
```

---

## 8. 제외 항목 (2차 이후)

- 로그인/회원가입 (소셜 로그인)
- 서버/DB 연동
- 사용자별 데이터 분리
- 데이터 공개/공유 기능
- 다른 국가 지도
- 통계 대시보드
- PWA/오프라인 지원
- 다국어 지원

---

## 9. 벤치마킹

### 9.1 StubbyPlanner
- **URL**: https://www.stubbyplanner.com
- **서비스 유형**: 유럽 여행 일정 플래너

#### 주요 기능
- 드래그 앤 드롭 루트 생성
- AI 기반 여행 추천 (3가지 루트 옵션 생성)
- 여행 템플릿 (커플, 가족, 솔로 여행자별)
- 비용 추산 (항공, 숙박, 교통, 투어)
- 국가별 가이드 및 코스

#### 디자인 특징
| 요소 | 상세 |
|------|------|
| 메인 컬러 | 에메랄드 그린 (#29bb8f) |
| 배경 | 크림색 (#fff7e3) |
| 레이아웃 | 카드 기반, 호버 애니메이션 |
| 효과 | Glassmorphism, 프로그레스 바 애니메이션 |

#### UX 패턴
- **진입점**: 직접 루트 생성 / 템플릿 복사 / AI 추천
- **Progressive Disclosure**: 모달 다이얼로그로 정보 순차 노출
- **실시간 피드백**: 로딩 상태, 애니메이션 진행률 (0-100%)
- **반응형**: 640px 이하 모바일 최적화, 스크롤 기반 헤더 show/hide

#### 지도 기능
- Mapbox 스타일 사용
- 루트 시각화 (이미지 URL, trip-gene 식별자)
- RouteMap 표시 함수
- 인터랙티브 임베딩보다 시각적 루트 미리보기 중심

#### Chizu 적용 포인트
- [ ] 프로그레스 바 애니메이션 적용
- [ ] 카드 호버 효과 (scale transform)
- [ ] Glassmorphism 오버레이
- [ ] 스크롤 기반 헤더 동작

---

## 10. 참고 자료

### 라이브러리 문서
- [react-simple-maps](https://www.react-simple-maps.io/)
- [D3-geo](https://github.com/d3/d3-geo)
- [Dexie.js](https://dexie.org/)
- [Zustand](https://github.com/pmndrs/zustand)
- [Radix UI](https://www.radix-ui.com/)

### GeoJSON 데이터
- [통계청 통계지리정보서비스](https://sgis.kostat.go.kr/)
- [국가공간정보포털](http://www.nsdi.go.kr/)
- [GitHub: southkorea](https://github.com/southkorea)
